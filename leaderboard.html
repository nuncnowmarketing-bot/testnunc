<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>nunc</title>
  <style>
    :root{
      --bg:#121212;
      --panel:#161616;
      --panel2:#1b1b1b;
      --text:#ffffff;
      --muted:rgba(255,255,255,0.70);
      --hair:rgba(255,255,255,0.12);
      --pill:rgba(255,255,255,0.06);
      --pillHover:rgba(255,255,255,0.10);
      --danger:rgba(255,255,255,0.08);
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;
      min-height:100vh;
      background:transparent; /* painted by fixed layer below */
      color:var(--text);
      font-family:Garamond,"EB Garamond","Cormorant Garamond","Times New Roman",serif;
      letter-spacing:0.2px;
      position:relative;
    }

    /* Always-dark viewport background (prevents white gutters/overscroll in embeds/previews) */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      background:var(--bg);
      z-index:-1;
    }

    a{color:inherit;text-decoration:none}

    .wrap{
      min-height:100%;
      display:flex;
      flex-direction:column;
    }

    header{
      position:sticky;
      top:0;
      background:rgba(18,18,18,0.94);
      border-bottom:1px solid var(--hair);
      z-index:10;
      backdrop-filter:saturate(140%) blur(8px);
    }

    .nav{
      max-width:1080px;
      margin:0 auto;
      padding:18px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    .brand{display:flex;align-items:baseline;gap:12px}

    .logo{
      font-size:30px;
      font-weight:600;
      line-height:1;
    }

    .nav-actions{display:flex;gap:10px}

    .pill{
      padding:8px 14px;
      border:1px solid var(--hair);
      border-radius:999px;
      background:var(--pill);
      font-size:14px;
      font-family:inherit;
      display:inline-block;
    }

    .pill:hover{background:var(--pillHover)}

    main{
      flex:1;
      width:100%;
      max-width:1280px;
      margin:0 auto;
      padding:18px 20px 56px;
      display:block;
    }

    /* Feed shell (Twitter/Threads-like: dense, scroll-first) */
    .feed-shell{
      width:100%;
      max-width:100%;
      margin:0;
      border-left:1px solid var(--hair);
      border-right:1px solid var(--hair);
      border-top:1px solid var(--hair);
      border-bottom:1px solid var(--hair);
      background:var(--panel);
      border-radius:0;
      overflow:hidden;
    }

    .feed-header{
      padding:18px 18px 14px;
      border-bottom:1px solid var(--hair);
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
    }

    .feed-title{
      font-size:22px;
      font-weight:600;
      margin:0;
      letter-spacing:0.1px;
    }

    .feed-sub{
      font-size:13px;
      color:var(--muted);
      letter-spacing:0.6px;
      text-transform:uppercase;
      white-space:nowrap;
    }

    .feed{
      display:flex;
      flex-direction:column;
    }

    .post{
      display:grid;
      grid-template-columns: 64px 1fr 44px;
      gap:14px;
      padding:16px 18px;
      border-bottom:1px solid var(--hair);
    }

    .rank{
      font-size:14px;
      color:var(--muted);
      text-align:right;
      padding-top:2px;
      white-space:nowrap;
    }

    .content{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0;
    }

    .title{
      font-size:18px;
      font-weight:600;
      line-height:1.25;
      word-wrap:break-word;
      overflow-wrap:anywhere;
    }

    .meta{
      font-size:13px;
      line-height:1.35;
      color:var(--muted);
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .dot{
      width:3px;
      height:3px;
      border-radius:999px;
      background:var(--muted);
      opacity:0.6;
      display:inline-block;
      transform:translateY(-1px);
    }

    .boost{
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      color:var(--muted);
      cursor:pointer;
      user-select:none;
      width:44px;
      height:36px;
      border:1px solid transparent;
      border-radius:10px;
      background:transparent;
    }

    .boost:hover{
      color:var(--text);
      border-color:var(--hair);
      background:var(--pill);
    }

    .boost::after{
      content:"boost";
      position:absolute;
      bottom:120%;
      right:0;
      padding:6px 10px;
      font-size:12px;
      color:var(--text);
      background:var(--panel2);
      border:1px solid var(--hair);
      border-radius:8px;
      white-space:nowrap;
      opacity:0;
      pointer-events:none;
      transform:translateY(4px);
      transition:opacity 0.15s ease, transform 0.15s ease;
    }

    .boost:hover::after{opacity:1;transform:translateY(0)}

    .feed-footer{
      padding:14px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      color:var(--muted);
      font-size:13px;
      border-top:1px solid var(--hair);
      background:linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,0.12));
    }

    .status{
      display:flex;
      align-items:center;
      gap:10px;
      min-height:20px;
    }

    .spinner{
      width:14px;
      height:14px;
      border-radius:999px;
      border:2px solid var(--hair);
      border-top-color:rgba(255,255,255,0.55);
      animation:spin 0.8s linear infinite;
      display:none;
    }

    .loading .spinner{display:inline-block}

    @keyframes spin{to{transform:rotate(360deg)}}

    footer{
      border-top:1px solid var(--hair);
      background:var(--panel);
    }

    /* Prevent white "rubber-band" overscroll in some previews */
    @supports (-webkit-touch-callout: none){
      html, body{background:var(--bg);}
    }

    .foot{
      max-width:1080px;
      margin:0 auto;
      padding:20px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
    }

    /* Mobile tightening */
    @media (max-width:520px){
      main{padding:12px 12px 48px}
      .post{grid-template-columns:56px 1fr 44px; padding:14px 14px}
      .feed-header{padding:16px 14px 12px}
      .title{font-size:17px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="nav">
        <div class="brand">
          <div class="logo">nunc</div>
        </div>

        <div class="nav-actions">
          <a class="pill" href="leaderboard.html">leaderboard</a>
          <a class="pill" href="map.html">map</a>
          <a class="pill" href="post.html">post</a>
          <a class="pill" href="login.html">log in</a>
        </div>
      </div>
    </header>

    <main>
      <section class="feed-shell" aria-label="Global feed">
        <div class="feed-header">
          <h2 class="feed-title">Global leaderboard</h2>
          <div class="feed-sub">infinite</div>
        </div>

        <div id="feed" class="feed"></div>

        <div class="feed-footer" id="feedFooter">
          <div class="status" id="status">
            <span class="spinner" aria-hidden="true"></span>
            <span id="statusText">Loaded 0 posts</span>
          </div>
          <div id="hint">scroll</div>
        </div>

        <div id="sentinel" style="height:1px"></div>
      </section>
    </main>

    <footer>
      <div class="foot">
        <div>© nunc</div>
        <div>terms · transparency · ledger</div>
      </div>
    </footer>
  </div>

  <script>
    // Twitter/Threads-like feed behavior: render in batches; append when sentinel enters viewport.
    // For now: 50 sample posts, but infinite loading loop by recycling generated content.

    const FEED = document.getElementById('feed');
    const SENTINEL = document.getElementById('sentinel');
    const FOOTER = document.getElementById('feedFooter');
    const STATUS = document.getElementById('status');
    const STATUS_TEXT = document.getElementById('statusText');

    const countries = [
      'Japan','Germany','Brazil','Canada','South Africa','Ireland','France','Spain','Italy','Netherlands',
      'Sweden','Norway','Denmark','Finland','Poland','Czechia','Portugal','Greece','Turkey','Egypt',
      'Nigeria','Kenya','Morocco','India','Pakistan','Bangladesh','Thailand','Vietnam','Indonesia','Philippines',
      'Australia','New Zealand','Mexico','Argentina','Chile','Colombia','Peru','United States','United Kingdom','Switzerland',
      'Austria','Belgium','Hungary','Romania','Bulgaria','Ukraine','Israel','UAE','Saudi Arabia','Singapore'
    ];

    const prompts = [
      'Conviction beats correctness when incentives are misaligned.',
      'If a platform hides the price, it is selling you to someone else.',
      'Attention is a budget. Most people spend it like it is infinite.',
      'Transparency hurts because it removes narratives.',
      'Markets pay for confidence, then punish for being wrong.',
      'If you cannot explain it simply, you are outsourcing thinking.',
      'Most "debates" are status games disguised as logic.',
      'The algorithm is not neutral. It is a business model.',
      'Outrage is a distribution strategy.',
      'The easiest way to win is to choose games with honest scoring.'
    ];

    const timeLabels = ['just now','1m','3m','6m','10m','18m','25m','40m','1h','2h','4h','7h','12h','18h','23h'];

    function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function makePost(rank){
      const title = rand(prompts);
      const country = rand(countries);
      const t = rand(timeLabels);

      const row = document.createElement('div');
      row.className = 'post';

      const rankEl = document.createElement('div');
      rankEl.className = 'rank';
      rankEl.textContent = `#${rank}`;

      const content = document.createElement('div');
      content.className = 'content';

      const titleEl = document.createElement('div');
      titleEl.className = 'title';
      titleEl.textContent = title;

      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.innerHTML = `${country} <span class="dot"></span> ${t}`;

      content.appendChild(titleEl);
      content.appendChild(meta);

      const boost = document.createElement('button');
      boost.className = 'boost';
      boost.type = 'button';
      boost.setAttribute('aria-label', 'boost');
      boost.textContent = '▲';

      row.appendChild(rankEl);
      row.appendChild(content);
      row.appendChild(boost);

      return row;
    }

    let nextRank = 1;
    let loaded = 0;
    const BATCH = 12;
    const SAMPLE_LIMIT = 50;

    function setLoading(isLoading){
      if(isLoading) STATUS.classList.add('loading');
      else STATUS.classList.remove('loading');
    }

    function updateStatus(){
      STATUS_TEXT.textContent = `Loaded ${loaded} posts`;
    }

    function appendBatch(){
      setLoading(true);

      // simulate network delay to make the infinite loader feel real
      window.setTimeout(() => {
        const frag = document.createDocumentFragment();

        for(let i=0;i<BATCH;i++){
          // Start with 50 unique sample ranks, then keep going (infinite) by continuing rank count.
          // This keeps the UI behavior identical to a real feed.
          const node = makePost(nextRank);
          frag.appendChild(node);
          nextRank++;
          loaded++;

          // ensure initial prototype has at least 50 posts quickly
          if(loaded === SAMPLE_LIMIT){
            // keep going infinitely; no stop condition
          }
        }

        FEED.appendChild(frag);
        updateStatus();
        setLoading(false);
      }, 220);
    }

    // Initial content: load enough to start scrolling immediately.
    appendBatch();
    appendBatch();

    const io = new IntersectionObserver((entries) => {
      for(const e of entries){
        if(e.isIntersecting){
          appendBatch();
        }
      }
    }, { root:null, rootMargin:'600px 0px', threshold:0 });

    io.observe(SENTINEL);

    updateStatus();
  </script>
</body>
</html>
